
> discogs-mcp@0.0.0 test
> vitest test/index.spec.ts


 DEV  v3.0.9 /Users/rian/Documents/GitHub/discogs-mcp

[vpw:info] Starting isolated runtimes for vitest.config.mts...
stdout | test/index.spec.ts > Discogs MCP Server > should handle initialize request
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle parse errors
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle empty body
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

 â¯ test/index.spec.ts (6 tests | 4 failed) 44ms
   Ã— Discogs MCP Server > should handle initialize request 11ms
     â†’ expected 404 to be 200 // Object.is equality
   Ã— Discogs MCP Server > should return server info for GET requests to main endpoint 4ms
     â†’ expected { name: 'Discogs MCP Server', â€¦(3) } to match object { name: 'Discogs MCP Server', â€¦(3) }
   Ã— Discogs MCP Server > should handle parse errors 2ms
     â†’ expected 404 to be 200 // Object.is equality
   Ã— Discogs MCP Server > should handle empty body 3ms
     â†’ expected 404 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return 404 for unknown paths
   âœ“ Discogs MCP Server > should return 404 for unknown paths

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 4 â¯â¯â¯â¯â¯â¯â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle initialize request
AssertionError: expected 404 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 404

 â¯ test/index.spec.ts:33:27
     31|   await waitOnExecutionContext(ctx)
     32| 
     33|   expect(response.status).toBe(200)
       |                           ^
     34|   expect(response.headers.get('content-type')).toBe('application/json')
     35| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/4]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should return server info for GET requests to main endpoint
AssertionError: expected { name: 'Discogs MCP Server', â€¦(3) } to match object { name: 'Discogs MCP Server', â€¦(3) }

- Expected
+ Received

  {
-   "description": "Model Context Protocol server for Discogs collection access",
+   "description": "Model Context Protocol server for Discogs collection access (SDK-based)",
    "endpoints": Any<Object>,
    "name": "Discogs MCP Server",
    "version": "1.0.0",
  }

 â¯ Proxy.methodWrapper Users/rian/Documents/GitHub/discogs-mcp/node_modules/.vite/vitest/deps_ssr/chai.js:1537:25
 â¯ test/index.spec.ts:66:18
     64| 
     65|   const result = await response.json()
     66|   expect(result).toMatchObject({
       |                  ^
     67|    name: 'Discogs MCP Server',
     68|    version: '1.0.0',

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/4]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle parse errors
AssertionError: expected 404 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 404

 â¯ test/index.spec.ts:84:27
     82|   await waitOnExecutionContext(ctx)
     83| 
     84|   expect(response.status).toBe(200) // JSON-RPC errors still return 200
       |                           ^
     85|   const result = await response.json()
     86|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/4]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle empty body
AssertionError: expected 404 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 404

 â¯ test/index.spec.ts:106:27
    104|   await waitOnExecutionContext(ctx)
    105| 
    106|   expect(response.status).toBe(200)
       |                           ^
    107|   const result = await response.json()
    108|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/4]â¯


 Test Files  1 failed (1)
      Tests  4 failed | 2 passed (6)
   Start at  06:59:47
   Duration  1.67s (transform 109ms, setup 0ms, collect 576ms, tests 44ms, environment 0ms, prepare 172ms)

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  test/index.spec.ts x1 
        Filename pattern: test/index.spec.ts

[vpw:debug] Reusing runtime for vitest.config.mts...
stdout | test/index.spec.ts > Discogs MCP Server > should handle initialize request
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle parse errors
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle empty body
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

 â¯ test/index.spec.ts (6 tests | 3 failed) 164ms
   Ã— Discogs MCP Server > should handle initialize request 10ms
     â†’ expected 406 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return server info for GET requests to main endpoint
   Ã— Discogs MCP Server > should handle parse errors 6ms
     â†’ expected 406 to be 200 // Object.is equality
   Ã— Discogs MCP Server > should handle empty body 18ms
     â†’ expected 406 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return 404 for unknown paths
   âœ“ Discogs MCP Server > should return 404 for unknown paths

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 3 â¯â¯â¯â¯â¯â¯â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle initialize request
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:33:27
     31|   await waitOnExecutionContext(ctx)
     32| 
     33|   expect(response.status).toBe(200)
       |                           ^
     34|   expect(response.headers.get('content-type')).toBe('application/json')
     35| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/3]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle parse errors
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:84:27
     82|   await waitOnExecutionContext(ctx)
     83| 
     84|   expect(response.status).toBe(200) // JSON-RPC errors still return 200
       |                           ^
     85|   const result = await response.json()
     86|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/3]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle empty body
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:106:27
    104|   await waitOnExecutionContext(ctx)
    105| 
    106|   expect(response.status).toBe(200)
       |                           ^
    107|   const result = await response.json()
    108|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/3]â¯


 Test Files  1 failed (1)
      Tests  3 failed | 3 passed (6)
   Start at  07:00:23
   Duration  591ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  test/index.spec.ts x2 
        Filename pattern: test/index.spec.ts

[vpw:debug] Reusing runtime for vitest.config.mts...
stdout | test/index.spec.ts > Discogs MCP Server > should handle initialize request
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle parse errors
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle empty body
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

 â¯ test/index.spec.ts (6 tests | 3 failed) 187ms
   Ã— Discogs MCP Server > should handle initialize request 12ms
     â†’ expected 406 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return server info for GET requests to main endpoint
   Ã— Discogs MCP Server > should handle parse errors 6ms
     â†’ expected 406 to be 200 // Object.is equality
   Ã— Discogs MCP Server > should handle empty body 9ms
     â†’ expected 406 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return 404 for unknown paths
   âœ“ Discogs MCP Server > should return 404 for unknown paths

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 3 â¯â¯â¯â¯â¯â¯â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle initialize request
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:34:27
     32|   await waitOnExecutionContext(ctx)
     33| 
     34|   expect(response.status).toBe(200)
       |                           ^
     35|   expect(response.headers.get('content-type')).toBe('application/json')
     36| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/3]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle parse errors
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:89:11
     87|   await waitOnExecutionContext(ctx)
     88| 
     89|   expect(response.status).toBe(200) // JSON-RPC errors still return 200
       |           ^
     90|   const result = await response.json()
     91|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/3]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle empty body
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:115:4
    113|   await waitOnExecutionContext(ctx)
    114| 
    115|   expect(response.status).toBe(200)
       |    ^
    116|   const result = await response.json()
    117|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/3]â¯


 Test Files  1 failed (1)
      Tests  3 failed | 3 passed (6)
   Start at  07:02:24
   Duration  792ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
c[3J RERUN  test/index.spec.ts x3 
        Filename pattern: test/index.spec.ts

[vpw:debug] Reusing runtime for vitest.config.mts...
stdout | test/index.spec.ts > Discogs MCP Server > should handle initialize request
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle parse errors
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

stdout | test/index.spec.ts > Discogs MCP Server > should handle empty body
[MCP] Session ID: mcp-efa543eedde602b1b37f96fe50283eb1 (source: deterministic)

 â¯ test/index.spec.ts (6 tests | 3 failed) 237ms
   Ã— Discogs MCP Server > should handle initialize request 8ms
     â†’ expected 406 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return server info for GET requests to main endpoint
   Ã— Discogs MCP Server > should handle parse errors 24ms
     â†’ expected 406 to be 200 // Object.is equality
   Ã— Discogs MCP Server > should handle empty body 10ms
     â†’ expected 406 to be 200 // Object.is equality
   âœ“ Discogs MCP Server > should return 404 for unknown paths
   âœ“ Discogs MCP Server > should return 404 for unknown paths

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 3 â¯â¯â¯â¯â¯â¯â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle initialize request
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:34:27
     32|   await waitOnExecutionContext(ctx)
     33| 
     34|   expect(response.status).toBe(200)
       |                           ^
     35|   expect(response.headers.get('content-type')).toBe('application/json')
     36| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/3]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle parse errors
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:89:11
     87|   await waitOnExecutionContext(ctx)
     88| 
     89|   expect(response.status).toBe(200) // JSON-RPC errors still return 200
       |           ^
     90|   const result = await response.json()
     91|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/3]â¯

 FAIL  test/index.spec.ts > Discogs MCP Server > should handle empty body
AssertionError: expected 406 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 406

 â¯ test/index.spec.ts:115:4
    113|   await waitOnExecutionContext(ctx)
    114| 
    115|   expect(response.status).toBe(200)
       |    ^
    116|   const result = await response.json()
    117|   expect(result).toMatchObject({

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/3]â¯


 Test Files  1 failed (1)
      Tests  3 failed | 3 passed (6)
   Start at  07:04:42
   Duration  550ms

 FAIL  Tests failed. Watching for file changes...
       press h to show help, press q to quit
Test removed... [ test/index.spec.ts ]

